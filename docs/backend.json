{
  "entities": {
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents a customer order at the bar.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order."
        },
        "createdAt": {
          "type": "number",
          "description": "The timestamp when the order was placed."
        },
        "status": {
          "type": "string",
          "description": "The current status of the order (e.g., 'готовится', 'завершен').",
          "enum": ["готовится", "завершен"]
        },
        "items": {
          "type": "array",
          "description": "A list of items in the order.",
          "items": { "$ref": "#/backend/entities/OrderItem" }
        },
        "customerId": {
          "type": "string",
          "description": "Optional reference to a Customer."
        },
        "customerName": {
          "type": "string",
          "description": "Name of the customer or 'Гость'."
        },
        "totalPrice": {
          "type": "number",
          "description": "The total price of the order."
        },
        "paymentMethod": {
          "type": "string",
          "description": "Payment method used for the order.",
          "enum": ["card", "cash"]
        }
      },
      "required": [
        "id",
        "createdAt",
        "status",
        "items",
        "customerName",
        "totalPrice",
        "paymentMethod"
      ]
    },
    "OrderItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "OrderItem",
      "type": "object",
      "description": "Represents a single item within an order.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "price": { "type": "number" },
        "customizations": { "type": "string" },
        "finalPrice": { "type": "number" }
      },
      "required": ["id", "name", "price", "finalPrice"]
    },
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the customer."
        },
        "phoneNumber": {
          "type": "string",
          "description": "The customer's phone number."
        },
        "name": {
          "type": "string",
          "description": "The customer's name."
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about the customer."
        }
      },
      "required": [
        "id",
        "phoneNumber"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Stores customer information, using the customerId as the document ID.",
          "params": [
            {
              "name": "customerId",
              "description": "Unique identifier for the customer. This is derived from the customer's phone number."
            }
          ]
        }
      },
      {
        "path": "/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores all orders for the application.",
          "params": [
             {
              "name": "orderId",
              "description": "Unique identifier for the order."
            }
          ]
        }
      }
    ]
  }
}
